<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>perpl.modelling.linearrepeatmodels &#8212; PERPL  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for perpl.modelling.linearrepeatmodels</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">linearrepeatmodels.py</span>

<span class="sd">Library of functions for regularly repeating linear patterns in models of</span>
<span class="sd">cellular structures.</span>

<span class="sd">Alistair Curd</span>
<span class="sd">University of Leeds</span>
<span class="sd">August 2019</span>

<span class="sd">Software Engineering practices applied</span>

<span class="sd">Joanna Leng (an EPSRC funded Research Software Engineering Fellow (EP/R025819/1)</span>
<span class="sd">University of Leeds</span>
<span class="sd">August 2019</span>

<span class="sd">---</span>
<span class="sd">Copyright 2018 Peckham Lab</span>

<span class="sd">Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use</span>
<span class="sd">this file except in compliance with the License. You may obtain a copy of the</span>
<span class="sd">License at</span>
<span class="sd">http://www.apache.org/licenses/LICENSE-2.0</span>

<span class="sd">Unless required by applicable law or agreed to in writing, software distributed</span>
<span class="sd">under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR</span>
<span class="sd">CONDITIONS OF ANY KIND, either express or implied. See the License for the</span>
<span class="sd">specific language governing permissions and limitations under the License.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">perpl.modelling.modelling_general</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">perpl.modelling.modelling_general</span><span class="w"> </span><span class="kn">import</span> <span class="n">pairwise_correlation_1d</span>


<div class="viewcode-block" id="noslope">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.noslope">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">noslope</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">mean</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the rpd (relative position density) which is a meansures</span>
<span class="sd">    the variation in a set of data.</span>
<span class="sd">    Args:</span>
<span class="sd">        x_values: A numpy array</span>
<span class="sd">        mean: A single float or int value</span>
<span class="sd">    Return:</span>
<span class="sd">        rpd: A numpy array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linear_fit">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linear_fit">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linear_fit</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x_values</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linear_fit_vector_args">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linear_fit_vector_args">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linear_fit_vector_args</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">linear_fit</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="justreplocs">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.justreplocs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">justreplocs</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Linear background</span>

    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="justreplocs_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.justreplocs_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">justreplocs_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
     <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">justreplocs</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="onepeakplusreps">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.onepeakplusreps">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">onepeakplusreps</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                    <span class="n">a</span><span class="p">,</span>
                    <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                    <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                    <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Linear background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>

    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="onepeakplusreps_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.onepeakplusreps_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">onepeakplusreps_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span>
     <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">onepeakplusreps</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                          <span class="n">a</span><span class="p">,</span>
                          <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                          <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="onepeakplusreps_no_bg">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.onepeakplusreps_no_bg">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">onepeakplusreps_no_bg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                          <span class="n">a</span><span class="p">,</span>
                          <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>

    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="onepeakplusreps_no_bg_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.onepeakplusreps_no_bg_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">onepeakplusreps_no_bg_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span>
     <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">onepeakplusreps_no_bg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                <span class="n">a</span><span class="p">,</span>
                                <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="onepeakplusreps_flat_bg">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.onepeakplusreps_flat_bg">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">onepeakplusreps_flat_bg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                          <span class="n">a</span><span class="p">,</span>
                          <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                          <span class="n">bgoffset</span><span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">+</span> <span class="n">bgoffset</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>

    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="onepeakplusreps_flat_bg_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.onepeakplusreps_flat_bg_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">onepeakplusreps_flat_bg_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span>
     <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
     <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">onepeakplusreps_flat_bg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                <span class="n">a</span><span class="p">,</span>
                                <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                                <span class="n">bgoffset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="onepeaknoreps">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.onepeaknoreps">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">onepeaknoreps</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                  <span class="n">a</span><span class="p">,</span>
                  <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                  <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Linear background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="onepeaknoreps_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.onepeaknoreps_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">onepeaknoreps_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">onepeaknoreps</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                      <span class="n">a</span><span class="p">,</span>
                      <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                      <span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepplusreps">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>  <span class="c1"># e, f,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span>  <span class="c1"># , e, f]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span> <span class="o">&lt;</span> <span class="n">broadening</span> <span class="o">*</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">gauss1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>

    <span class="n">background</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">background</span>
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepplusreps3">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps3">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps3</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span>
                    <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                    <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                    <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Linear background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                        <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                        <span class="n">broadening</span><span class="p">)</span>
    <span class="c1"># Repeated localisations</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                           <span class="mf">0.</span><span class="p">,</span>
                                                           <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="offsetlinrepplusreps3flatbg">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.offsetlinrepplusreps3flatbg">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">offsetlinrepplusreps3flatbg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span>
                                <span class="n">peakoffset</span><span class="p">,</span>
                                <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                                <span class="n">bgoffset</span>
                                <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Linear background</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="p">(</span><span class="n">rpd</span>
               <span class="o">+</span> <span class="n">amp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                           <span class="n">peakoffset</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                           <span class="n">broadening</span><span class="p">)</span>
               <span class="p">)</span>

    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepplusreps3fixedpeaks">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps3fixedpeaks">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps3fixedpeaks</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepplusreps3fixedpeaksflatbg">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps3fixedpeaksflatbg">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps3fixedpeaksflatbg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span> <span class="c1"># rep locs</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepplusreps3fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps3fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps3fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span> <span class="c1"># rep locs</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepplusreps3fixedpeakratiovectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps3fixedpeakratiovectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps3fixedpeakratiovectorinput</span><span class="p">(</span><span class="n">vectorin</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">amp</span><span class="p">,</span>
     <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vectorin</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">linrepplusreps3fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                      <span class="n">amp</span><span class="p">,</span>
                                      <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                                      <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                                      <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="linrepplusreps3fixedpeakamp">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps3fixedpeakamp">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps3fixedpeakamp</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span>  <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="offsetlinrepplusreps3fixedpeakampflatbg">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.offsetlinrepplusreps3fixedpeakampflatbg">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">offsetlinrepplusreps3fixedpeakampflatbg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">peakoffset</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span>  <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span>
                                    <span class="n">x_values</span><span class="p">,</span> <span class="n">peakoffset</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="offsetlinrep3fixedpeakamp">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.offsetlinrep3fixedpeakamp">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">offsetlinrep3fixedpeakamp</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">peakoffset</span><span class="p">,</span>
                   <span class="n">bgoffset</span>
                   <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Offset peak plus 3 more at repeat distance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span>  <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span>
                                    <span class="n">x_values</span><span class="p">,</span> <span class="n">peakoffset</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="c1">#reps = ampreplocs * x_values / (2 * locprec ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec ** 2))</span>
    <span class="c1">#rpd = rpd + reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="offsetlinrep3fixedpeakampnobg">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.offsetlinrep3fixedpeakampnobg">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">offsetlinrep3fixedpeakampnobg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">peakoffset</span>
                   <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Offset peak plus 3 more at repeat distance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span>  <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span>
                                    <span class="n">x_values</span><span class="p">,</span> <span class="n">peakoffset</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="c1">#reps = ampreplocs * x_values / (2 * locprec ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec ** 2))</span>
    <span class="c1">#rpd = rpd + reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepbroadsplusreps3fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepbroadsplusreps3fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepbroadsplusreps3fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span>
                                  <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b3</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b3</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>    
    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrep19plusreps3fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrep19plusreps3fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrep19plusreps3fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">rep</span> <span class="o">=</span> <span class="mf">19.2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepnoreps3fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps3fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps3fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    

    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrep19noreps3fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrep19noreps3fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrep19noreps3fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">rep</span> <span class="o">=</span> <span class="mf">19.2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    

    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepnoreps3fixedpeaks">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps3fixedpeaks">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps3fixedpeaks</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
 
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepplusreps4">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps4">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps4</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepplusreps4fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps4fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps4fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>
    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepplusreps4fixedpeakratiovectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps4fixedpeakratiovectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps4fixedpeakratiovectorinput</span><span class="p">(</span><span class="n">vectorin</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">amp</span><span class="p">,</span>
     <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vectorin</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">linrepplusreps4fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                      <span class="n">amp</span><span class="p">,</span>
                                      <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                                      <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                                      <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="linrepplusreps4fixedpeakrationobg">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps4fixedpeakrationobg">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps4fixedpeakrationobg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>
    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepbroadsplusreps4fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepbroadsplusreps4fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepbroadsplusreps4fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span>
                    <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b3</span><span class="p">,</span> <span class="n">b4</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b3</span><span class="p">,</span> <span class="n">b4</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>

    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrep19plusreps4fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrep19plusreps4fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrep19plusreps4fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">rep</span> <span class="o">=</span> <span class="mf">19.2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>
    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>

    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps4_bg_linear">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps4_bg_linear">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps4_bg_linear</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                  <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                  <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                        <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                        <span class="n">broadening</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps4_bg_non_negative">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps4_bg_non_negative">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps4_bg_non_negative</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                                  <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                                  <span class="p">):</span>
    <span class="n">background</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Background</span>
    <span class="n">background</span><span class="p">[</span><span class="n">background</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c1"># Cannot be negative</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span> <span class="c1"># Amplitudes of four peaks</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">background</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                        <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                        <span class="n">broadening</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps4_bg_zero">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps4_bg_zero">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps4_bg_zero</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span>
                  <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                        <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                        <span class="n">broadening</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps4_bg_linear_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps4_bg_linear_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps4_bg_linear_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
     <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">linrepnoreps4_bg_linear</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                      <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                      <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                      <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="linrepnoreps4_bg_zero_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps4_bg_zero_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps4_bg_zero_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
     <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">linrepnoreps4_bg_zero</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                      <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                      <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span>
                      <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="linrepnoreps4fixedpeaks">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps4fixedpeaks">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps4fixedpeaks</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    

    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepnoreps4fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps4fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps4fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    

    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrep19noreps4fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrep19noreps4fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrep19noreps4fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">rep</span> <span class="o">=</span> <span class="mf">19.2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">4.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    

    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="lin_repeat_after_offset_4">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.lin_repeat_after_offset_4">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_repeat_after_offset_4</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                              <span class="n">first_peak_offset</span><span class="p">,</span>
                              <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                              <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                              <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Linear background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                  <span class="n">first_peak_offset</span>
                                                  <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                  <span class="n">broadening</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="lin_repeat_after_offset_4_vectorargs">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.lin_repeat_after_offset_4_vectorargs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_repeat_after_offset_4_vectorargs</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">first_peak_offset</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">lin_repeat_after_offset_4</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                  <span class="n">first_peak_offset</span><span class="p">,</span>
                                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                                  <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                                  <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="linrepplusreps5">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps5">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps5</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span> <span class="c1"># rep locs</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepplusreps5_bg_flat">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps5_bg_flat">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps5_bg_flat</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">x_values</span> <span class="o">*</span> <span class="mf">0.</span> <span class="o">+</span> <span class="n">bgoffset</span> <span class="c1"># Background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span> <span class="c1"># rep locs</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepplusreps5_bg_flat_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps5_bg_flat_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps5_bg_flat_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
     <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
     <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">linrepplusreps5_bg_flat</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                                  <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                                  <span class="n">bgoffset</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps5_bg_linear">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5_bg_linear">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5_bg_linear</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                  <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                  <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                        <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                        <span class="n">broadening</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps5_bg_flat">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5_bg_flat">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5_bg_flat</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                  <span class="n">bgoffset</span>
                  <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">x_values</span> <span class="o">*</span> <span class="mf">0.</span> <span class="o">+</span> <span class="n">bgoffset</span>  <span class="c1"># Background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                        <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                        <span class="n">broadening</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps5_bg_non_negative">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5_bg_non_negative">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5_bg_non_negative</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                                  <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                                  <span class="p">):</span>
    <span class="n">background</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Background</span>
    <span class="n">background</span><span class="p">[</span><span class="n">background</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c1"># Cannot be negative</span>
    
    <span class="c1"># Include five peaks on linear repeat</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span> <span class="c1"># Amplitudes of five peaks</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                        <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                        <span class="n">broadening</span><span class="p">)</span>
    
    <span class="c1"># Add background</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">background</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps5_bg_zero">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5_bg_zero">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5_bg_zero</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span>
                  <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                        <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                        <span class="n">broadening</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps5_bg_linear_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5_bg_linear_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5_bg_linear_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
     <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">linrepnoreps5_bg_linear</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                      <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                      <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                      <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="linrepnoreps5_bg_flat_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5_bg_flat_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5_bg_flat_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
     <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
     <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">linrepnoreps5_bg_flat</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                      <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                      <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                      <span class="n">bgoffset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="linrepnoreps5_bg_zero_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5_bg_zero_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5_bg_zero_vectorinput</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
     <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">linrepnoreps5_bg_zero</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                      <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                      <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span>
                      <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="randplusreps5">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.randplusreps5">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">randplusreps5</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">xd</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span>
                   <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">xd</span><span class="p">,</span> <span class="n">xe</span><span class="p">]</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">broadening</span><span class="p">)</span>    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepplusreps5fixedpeak">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps5fixedpeak">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps5fixedpeak</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepplusreps5fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps5fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps5fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span> <span class="c1"># rep locs</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepplusreps5fixedpeakratiovectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps5fixedpeakratiovectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps5fixedpeakratiovectorinput</span><span class="p">(</span><span class="n">vectorin</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">amp</span><span class="p">,</span>
     <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vectorin</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">linrepplusreps5fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                      <span class="n">amp</span><span class="p">,</span>
                                      <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                                      <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                                      <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="linrepnoreps5_fixedpeakratio">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5_fixedpeakratio">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5_fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps5_fixedpeakratio_vectorinput">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5_fixedpeakratio_vectorinput">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5_fixedpeakratio_vectorinput</span><span class="p">(</span><span class="n">vectorin</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">amp</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vectorin</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">linrepnoreps5_fixedpeakratio</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                      <span class="n">amp</span><span class="p">,</span>
                                      <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                                      <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="lin_repeat_after_offset_5">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.lin_repeat_after_offset_5">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_repeat_after_offset_5</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                              <span class="n">first_peak_offset</span><span class="p">,</span>
                              <span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                              <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                              <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>  <span class="c1"># Linear background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                  <span class="n">first_peak_offset</span>
                                                  <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                  <span class="n">broadening</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="lin_repeat_after_offset_5_vectorargs">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.lin_repeat_after_offset_5_vectorargs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_repeat_after_offset_5_vectorargs</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">first_peak_offset</span><span class="p">,</span>
     <span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
     <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">lin_repeat_after_offset_5</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                  <span class="n">first_peak_offset</span><span class="p">,</span>
                                  <span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                                  <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                                  <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="lin_repeat_after_offset_5_no_bg">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.lin_repeat_after_offset_5_no_bg">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_repeat_after_offset_5_no_bg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                              <span class="n">first_peak_offset</span><span class="p">,</span>
                              <span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span>
                              <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                  <span class="n">first_peak_offset</span>
                                                  <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                  <span class="n">broadening</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="lin_repeat_after_offset_5_no_bg_vectorargs">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.lin_repeat_after_offset_5_no_bg_vectorargs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_repeat_after_offset_5_no_bg_vectorargs</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">first_peak_offset</span><span class="p">,</span>
     <span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">lin_repeat_after_offset_5_no_bg</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                  <span class="n">first_peak_offset</span><span class="p">,</span>
                                  <span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span>
                                  <span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="lin_repeat_after_offset_5_flat_bg_replocs">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.lin_repeat_after_offset_5_flat_bg_replocs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_repeat_after_offset_5_flat_bg_replocs</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                              <span class="n">first_peak_offset</span><span class="p">,</span>
                                              <span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                                              <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                                              <span class="n">bgoffset</span><span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">+</span> <span class="n">bgoffset</span> <span class="c1"># Background</span>
    
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span>
                                                  <span class="n">first_peak_offset</span>
                                                  <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span>
                                                  <span class="n">broadening</span><span class="p">)</span>
    
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">locprec</span><span class="p">)</span> <span class="c1"># rep locs</span>
    
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="lin_repeat_after_offset_5_flat_bg_replocs_vectorargs">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.lin_repeat_after_offset_5_flat_bg_replocs_vectorargs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lin_repeat_after_offset_5_flat_bg_replocs_vectorargs</span><span class="p">(</span><span class="n">vector_input</span><span class="p">):</span>
    <span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
     <span class="n">first_peak_offset</span><span class="p">,</span>
     <span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
     <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
     <span class="n">bgoffset</span><span class="p">)</span> <span class="o">=</span> <span class="n">vector_input</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">lin_repeat_after_offset_5_flat_bg_replocs</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                                  <span class="n">first_peak_offset</span><span class="p">,</span>
                                  <span class="n">amp0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span>
                                  <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                                  <span class="n">bgoffset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span></div>



<div class="viewcode-block" id="linrepnoreps5fixedpeak">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5fixedpeak">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5fixedpeak</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepnoreps5fixedpeakratios">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps5fixedpeakratios">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps5fixedpeakratios</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="nobg5fixedpeakratios">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.nobg5fixedpeakratios">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">nobg5fixedpeakratios</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">x_values</span> <span class="o">-</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="nobg5fixedpeakratiosplusreps">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.nobg5fixedpeakratiosplusreps">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">nobg5fixedpeakratiosplusreps</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">amp</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">x_values</span> <span class="o">-</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">5.</span><span class="p">)</span> <span class="o">*</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    

    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>    
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>


<div class="viewcode-block" id="linrepplusreps6">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepplusreps6">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepplusreps6</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>    
    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="linrepnoreps6">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.linrepnoreps6">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">linrepnoreps6</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span>
                  <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                  <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span> <span class="o">&lt;</span> <span class="n">broadening</span> <span class="o">*</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">gauss1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">rep</span><span class="p">,</span> <span class="n">broadening</span><span class="p">)</span>

    <span class="n">background</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">background</span>

    <span class="k">return</span> <span class="n">rpd</span></div>



<div class="viewcode-block" id="randplusreps6">
<a class="viewcode-back" href="../../../perpl.modelling.html#perpl.modelling.linearrepeatmodels.randplusreps6">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">randplusreps6</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span>
                   <span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">xd</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">xf</span><span class="p">,</span>
                   <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span>
                   <span class="n">locprec</span><span class="p">,</span> <span class="n">ampreplocs</span><span class="p">,</span>
                   <span class="n">bgslope</span><span class="p">,</span> <span class="n">bgoffset</span>
                   <span class="p">):</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">bgoffset</span> <span class="o">+</span> <span class="n">bgslope</span> <span class="o">*</span> <span class="n">x_values</span> <span class="c1"># Linear background</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">xd</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">xf</span><span class="p">]</span>
    <span class="n">amps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">amps</span><span class="p">):</span>
        <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">pairwise_correlation_1d</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">broadening</span><span class="p">)</span>    
    <span class="n">reps</span> <span class="o">=</span> <span class="n">ampreplocs</span> <span class="o">*</span> <span class="n">x_values</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                                               <span class="o">-</span><span class="p">(</span><span class="n">x_values</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">locprec</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">rpd</span> <span class="o">=</span> <span class="n">rpd</span> <span class="o">+</span> <span class="n">reps</span>
    <span class="c1">#reps2 = ampreplocs2 * x_values / (2 * locprec2 ** 2) * np.exp(</span>
    <span class="c1">#                                           -(x_values ** 2) / (4 * locprec2 ** 2))</span>
    <span class="c1">#rpd = rpd + reps2</span>
    <span class="k">return</span> <span class="n">rpd</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">PERPL</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Alistair Curd.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>